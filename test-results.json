{"numFailedTestSuites":1,"numFailedTests":1,"numPassedTestSuites":0,"numPassedTests":4,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":5,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1758295595856,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["TwitterClient","request"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"TwitterClient request should make a successful GET request","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should make a successful GET request"},{"ancestorTitles":["TwitterClient","request"],"duration":1068,"failureDetails":[],"failureMessages":[],"fullName":"TwitterClient request should handle rate limiting with retry","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle rate limiting with retry"},{"ancestorTitles":["TwitterClient","request"],"duration":2056,"failureDetails":[],"failureMessages":[],"fullName":"TwitterClient request should throw after max retries","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should throw after max retries"},{"ancestorTitles":["TwitterClient","circuit breaker"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TwitterClient circuit breaker should open circuit after threshold is reached","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should open circuit after threshold is reached"},{"ancestorTitles":["TwitterClient","circuit breaker"],"duration":118,"failureDetails":[{"name":"TwitterRateLimitError","status":429,"rateLimitInfo":{"limit":0,"remaining":0,"reset":1758295599,"retryAfter":1}}],"failureMessages":["TwitterRateLimitError: Circuit breaker is open\n    at TwitterClient.<anonymous> (C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\client.ts:180:13)\n    at Generator.next (<anonymous>)\n    at C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\client.ts:8:71\n    at new Promise (<anonymous>)\n    at Object.<anonymous>.__awaiter (C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\client.ts:4:12)\n    at TwitterClient.request (C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\client.ts:86:16)\n    at TwitterClient.get (C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\client.ts:558:17)\n    at C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\__tests__\\client.test.ts:190:53\n    at Generator.next (<anonymous>)\n    at fulfilled (C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\__tests__\\client.test.ts:5:58)"],"fullName":"TwitterClient circuit breaker should close circuit after timeout","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should close circuit after timeout"}],"endTime":1758295599788,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mTwitterClient › circuit breaker › should close circuit after timeout\u001b[39m\u001b[22m\n\n    TwitterRateLimitError: Circuit breaker is open\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 178 |\u001b[39m       \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mmetrics\u001b[33m.\u001b[39mrecordCircuitBreakerTrip()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 179 |\u001b[39m       \u001b[36mconst\u001b[39m resetTime \u001b[33m=\u001b[39m \u001b[33mMath\u001b[39m\u001b[33m.\u001b[39mfloor((\u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow() \u001b[33m+\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39moptions\u001b[33m.\u001b[39mcircuitBreakerTimeout) \u001b[33m/\u001b[39m \u001b[35m1000\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 180 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mTwitterRateLimitError\u001b[39m(\u001b[32m'Circuit breaker is open'\u001b[39m\u001b[33m,\u001b[39m \u001b[35m429\u001b[39m\u001b[33m,\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 181 |\u001b[39m         limit\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m\u001b[33m,\u001b[39m \u001b[90m// No requests allowed when circuit is open\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 182 |\u001b[39m         remaining\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m\u001b[33m,\u001b[39m \u001b[90m// No requests remaining\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 183 |\u001b[39m         reset\u001b[33m:\u001b[39m resetTime\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat TwitterClient.<anonymous> (\u001b[22m\u001b[2msrc/lib/twitter/client.ts\u001b[2m:180:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2msrc/lib/twitter/client.ts\u001b[2m:8:71\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous>.__awaiter (\u001b[22m\u001b[2msrc/lib/twitter/client.ts\u001b[2m:4:12)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat TwitterClient.request (\u001b[22m\u001b[2msrc/lib/twitter/client.ts\u001b[2m:86:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat TwitterClient.get (\u001b[22m\u001b[2msrc/lib/twitter/client.ts\u001b[2m:558:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/twitter/__tests__/client.test.ts\u001b[39m\u001b[0m\u001b[2m:190:53\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat fulfilled (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/twitter/__tests__/client.test.ts\u001b[39m\u001b[0m\u001b[2m:5:58)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\cosyc\\ai-salvador\\src\\lib\\twitter\\__tests__\\client.test.ts","startTime":1758295596002,"status":"failed","summary":""}],"wasInterrupted":false}
