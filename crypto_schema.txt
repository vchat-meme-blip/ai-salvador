// Add these new table definitions to your existing schema in convex/schema.ts

// Village-wide state, including the treasury.
villageState: defineTable({
  treasury: v.number(),
}),

// Information about available crypto tokens.
tokens: defineTable({
  name: v.string(),
  symbol: v.string(),
  price: v.number(),
}).index('by_symbol', ['symbol']),

// Agent portfolios for holding tokens and cash.
portfolios: defineTable({
  playerId: v.id('players'),
  holdings: v.array(v.object({ tokenId: v.id('tokens'), amount: v.number() })),
  cashBalance: v.number(),
}).index('by_playerId', ['playerId']),

// News articles for agents to fetch and read.
news: defineTable({
  source: v.string(),
  headline: v.string(),
  content: v.string(),
  timestamp: v.number(),
  impact: v.optional(v.object({ 
    tokenId: v.id('tokens'), 
    sentiment: v.union(v.literal('positive'), v.literal('negative'), v.literal('neutral')) 
  })),
}),

// A log of all buy/sell transactions.
transactions: defineTable({
  playerId: v.id('players'),
  tokenId: v.id('tokens'),
  type: v.union(v.literal('buy'), v.literal('sell')),
  amount: v.number(),
  price: v.number(),
  timestamp: v.number(),
}).index('by_playerId', ['playerId']).index('by_tokenId', ['tokenId']),
